(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{272:function(e,t){},277:function(e,t,a){e.exports=a(670)},282:function(e,t,a){},283:function(e,t,a){},355:function(e,t){},357:function(e,t){},391:function(e,t){},392:function(e,t){},577:function(e,t,a){var n={"./geojson.json":251,"./table-schema.json":578,"./topojson.json":252};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=577},663:function(e,t){},664:function(e,t){},668:function(e,t){},669:function(e,t){},670:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(146),c=a.n(o),l=(a(282),a(283),a(28)),i=a(148),u=a.n(i);var s=function(e){var t=e.fields.find(function(e){return e.type&&e.type.includes("date")}),a=e.fields.filter(function(e){return!(e.type&&e.type.includes("date"))}),n=[{name:"=",label:"="},{name:"!=",label:"!="},{name:"<",label:"<"},{name:">",label:">"},{name:"<=",label:"<="},{name:">=",label:">="}];return r.a.createElement(l.d,{initialValues:{rules:[],startDate:null,endDate:null},onSubmit:function(a){return function(a){var n=JSON.parse(JSON.stringify(a)),r='SELECT COUNT(*) OVER (), * FROM "'.concat(e.resourceId,'" WHERE ');if(n.startDate||n.endDate||0!==n.rules.length){if(n.startDate){var o={combinator:"AND",field:t.name,operator:">=",value:n.startDate};n.rules.push(o)}if(n.endDate){var c={combinator:"AND",field:t.name,operator:"<=",value:n.endDate};n.rules.push(c)}n.rules.forEach(function(e,t){e.value=e.value instanceof Date?e.value.toISOString():e.value,r+=0===t?'"'.concat(e.field,'" ').concat(e.operator," '").concat(e.value,"'"):" ".concat(e.combinator.toUpperCase(),' "').concat(e.field,'" ').concat(e.operator," '").concat(e.value,"'")}),r+=" LIMIT 100"}else alert("Please, provide at least one rule.");var l=e.apiUrl+"datastore_search_sql?sql=".concat(r);fetch(encodeURI(l)).then(function(e){return e.json()}).then(function(t){var a=t.result.records[0]?t.result.records[0].count:0;document.getElementById("numberOfRows").innerText=a;var n=t.result.records.map(function(e){return delete e.count,delete e._id,delete e._full_text,e});window["table".concat(e.viewId)].updateData(n);var r=Object.keys(n[0]);window["table".concat(e.viewId)].addSettings({colHeaders:r,columns:void 0})}).catch(function(e){return console.error(e)})}(a)},render:function(e){var o=e.values,c=e.setFieldValue;return r.a.createElement(l.c,{className:"form-inline"},t?r.a.createElement("div",null,r.a.createElement(u.a,{value:o.startDate,clearIcon:"X",onChange:function(e){return c("startDate",e)},format:"yyyy-MM-dd",maxDate:new Date}),r.a.createElement("i",{className:"fa fa-long-arrow-right","aria-hidden":"true"}),r.a.createElement(u.a,{value:o.endDate,clearIcon:"X",onChange:function(e){return c("endDate",e)},returnValue:"end",format:"yyyy-MM-dd",minDate:o.startDate,maxDate:new Date})):"",r.a.createElement(l.b,{name:"rules",render:function(e){return r.a.createElement("div",null,o.rules&&o.rules.length>0?o.rules.map(function(t,o){return r.a.createElement("div",{key:o},r.a.createElement(l.a,{name:"rules.".concat(o,".combinator"),component:"select",className:"form-control",required:!0},r.a.createElement("option",{value:"AND"},"AND"),r.a.createElement("option",{value:"OR"},"OR")),r.a.createElement(l.a,{name:"rules.".concat(o,".field"),component:"select",className:"form-control",required:!0},a.map(function(e,t){return r.a.createElement("option",{value:e.name,key:"field".concat(t)},e.title||e.name)})),r.a.createElement(l.a,{name:"rules.".concat(o,".operator"),component:"select",className:"form-control",required:!0},n.map(function(e,t){return r.a.createElement("option",{value:e.name,key:"operator".concat(t)},e.label)})),r.a.createElement(l.a,{name:"rules.".concat(o,".value"),className:"form-control",required:!0}),r.a.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){return e.remove(o)}},"-"),r.a.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){return e.insert(o,{combinator:"AND",field:a[0].name,operator:"=",value:""})}},"+"))}):r.a.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){return e.push({combinator:"AND",field:a[0].name,operator:"=",value:""})}},"Add a rule"),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit")))}}))}})};var d=function(e){var t=e.view;return t.resources[0].schema?r.a.createElement("div",{className:"App"},r.a.createElement(s,{resourceId:t.resources[0].id,viewId:t.id,fields:t.resources[0].schema.fields,apiUrl:"https://www.energidataservice.dk/api/3/action/"})):r.a.createElement("div",{className:"no-filters"})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var m=a(276),f=a(326).Dataset,v=document.getElementsByClassName("react-me-datapackage-views");function p(e){try{return JSON.parse(e)}catch(t){return e}}var b=!0,E=!1,w=void 0;try{for(var y,h=v[Symbol.iterator]();!(b=(y=h.next()).done);b=!0){var D=p(y.value.getAttribute("data-datapackage-json"));f.load(D).then(function(e){(e.descriptor.views||[]).forEach(function(t){var a=Object(m.compileView)(t,e.descriptor);a.resources[0].datastore_active&&N(a)})}).catch(function(e){console.warn("Failed to load a Dataset from provided datapackage id\n"+e)})}}catch(g){E=!0,w=g}finally{try{b||null==h.return||h.return()}finally{if(E)throw w}}function N(e){c.a.render(r.a.createElement(d,{view:e}),document.getElementById("datapackage-filter-".concat(e.id)))}"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[277,1,2]]]);
//# sourceMappingURL=main.c32d715f.chunk.js.map